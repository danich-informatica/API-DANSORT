import{_ as O}from"./Dp2n3JP9.js";import{e as I,g as R,c as g,b as x,F as A,v as M,j as i,w as j,_ as B,o as d,n as m,a as o,x as G,t as C,y as J,z as K,A as z,B as y}from"#entry";import{u as b,s as c,A as k}from"./3xTCpF3_.js";import{u as $}from"./CmmS28rl.js";import{_ as F}from"./CcFceyxz.js";const L=()=>{const t=b();return{assignSku:r=>t.assignSku(r)}},H=()=>{const t=b();return{unassignSku:(r,f)=>t.unassignSku(r,f),unassignAllSku:r=>t.unassignAllSku(r)}};var p=(t=>(t.MODE_AUTOMATIC="automatico",t.MODE_MANUAL="manual",t))(p||{});const V=(t,r)=>t.is_enabled?r.is_master_case?"bg-blue-500":r.sku_name===c.SKU_REJECT?"bg-red-500":t.mode===p.MODE_AUTOMATIC&&t.is_enabled?"bg-lgreen3":t.mode===p.MODE_MANUAL&&t.is_enabled?"bg-yellow-600/90":"":"bg-gray-300",P={class:"flex justify-between items-start mx-1"},q={class:"text-2 font-bold text-dgreen1"},Q={class:"flex gap-1"},W=["onClick"],X=["onDrop"],Y={key:0,class:"flex flex-col gap-1 overflow-y-auto pr-1 my-1"},Z=["draggable","onDragstart"],ss={class:"relative w-full flex justify-start items-center h-8"},es={class:"px-1 text-xs font-bold"},ts=["onClick"],ns={key:1,class:"flex flex-col items-center justify-center h-full"},as={class:"mt-auto pt-2"},os=["onClick"],gs=I({__name:"Assignments",props:{sorter_id:{}},setup(t){const r=t,{getAssignments:f}=$(),{assignSku:N}=L(),{unassignSku:w,unassignAllSku:D}=H(),_=b(),E=(e,n)=>{const l=JSON.parse(e.dataTransfer?.getData("assignmentSku")??"");if(console.log(l),!l)return;const u={id:l.id??l.sku_id,sku:l.sku??l.sku_name},s=_.assignments.find(a=>a.sealer_db_id===n.sealer_db_id),S=s.assignments.find(a=>a.sku_name===u.sku);if(r.sorter_id===1&&s.mode.toUpperCase()===p.MODE_AUTOMATIC.toUpperCase()&&s.assignments.length>0){F(k.ASSIGNMENT_ERROR,!0,_.assignment_modals);return}S||N({sealer_id:s.sealer_db_id,sku_id:u.id})},U=e=>e.sku_name.toUpperCase()!==c.SKU_REJECT.toUpperCase()?!1:_.getSealersByType.flatMap(u=>u.assignments).filter(u=>u.sku_name.toUpperCase()===c.SKU_REJECT.toUpperCase()).length===1,v=(e,n,l)=>{e.dataTransfer&&e.dataTransfer.setData("assignmentSku",JSON.stringify({...n,sealer_id:l}))};return R(async()=>{await f(r.sorter_id)}),(e,n)=>{const l=O,u=B;return d(),g(A,null,[(d(!0),g(A,null,M(i(_).getSealersByType,(s,S)=>(d(),g("div",{key:S,class:m(["lg:w-60 xl:w-72 w-full p-1 mx-3 my-2 shadow-md bg-white flex flex-col justify-between",{"h-12":!s.is_expanded,"h-72":s.is_expanded}])},[o("div",P,[o("h1",q," Salida "+C(s.sealer_physical_id),1),o("div",Q,[o("button",{onClick:a=>s.is_expanded=!s.is_expanded,class:"p-0.5 border border-black rounded-md"},[(d(),J(K(s.is_expanded?"IconsArrowUp":"IconsArrowDown"),{size:"1.5em",class:"text-black"}))],8,W)])]),n[3]||(n[3]=o("hr",{class:"border w-full mt-1"},null,-1)),s.is_expanded?(d(),g("div",{key:0,onDragover:n[0]||(n[0]=z(()=>{},["prevent"])),onDrop:a=>E(a,s),class:"flex flex-col flex-grow overflow-hidden"},[s.assignments.length>0?(d(),g("div",Y,[(d(!0),g(A,null,M(s.assignments,(a,T)=>(d(),g("div",{key:T,class:m(["rounded-lg flex justify-center text-white",i(V)(s,a)]),draggable:a.sku_name.toUpperCase()!==("sku_values"in e?e.sku_values:i(c)).SKU_REJECT.toUpperCase(),onDragstart:h=>v(h,a,s.sealer_db_id)},[o("div",ss,[o("h1",es,C(a.sku_name),1),o("button",{onClick:h=>i(w)(s.sealer_db_id,a.sku_id),class:m(["absolute right-0 px-2 border-l border-white cursor-pointer",{hidden:U(a)}])},[x(l,{class:"transition-transform duration-300 hover:scale-120",size:"1.2em"})],10,ts)])],42,Z))),128))])):(d(),g("div",ns,[...n[2]||(n[2]=[o("h1",{class:"px-1 text-4 font-bold text-black"},"SIN SKUs ASIGNADOS",-1)])])),o("div",as,[o("button",{onClick:a=>i(D)(s.sealer_db_id),class:m(["p-1 bg-dred2 text-white text-4 w-full rounded-md cursor-pointer",{hidden:s.assignments.length===0}])}," DESASIGNAR TODO ",10,os)])],40,X)):G("",!0)],2))),128)),x(u,{toggle_modal:("getModalState"in e?e.getModalState:i(y))(("AssignmetModalNames"in e?e.AssignmetModalNames:i(k)).ASSIGNMENT_ERROR,i(_).assignment_modals).show,"onUpdate:toggle_modal":n[1]||(n[1]=s=>("getModalState"in e?e.getModalState:i(y))(("AssignmetModalNames"in e?e.AssignmetModalNames:i(k)).ASSIGNMENT_ERROR,i(_).assignment_modals).show=s)},{default:j(()=>[...n[4]||(n[4]=[o("div",{class:"flex flex-col items-center justify-center p-4"},[o("h1",{class:"title-4 text-dgreen1"},"ATENCIÓN"),o("p",{class:"mt-5 text-2 text-dgreen2"},"NO PUEDES ASIGNAR MÁS DE UN SKU A UNA SALIDA AUTOMÁTICA.")],-1)])]),_:1},8,["toggle_modal"])],64)}}});export{gs as _};
