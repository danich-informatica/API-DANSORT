import{_ as T}from"./Dp2n3JP9.js";import{e as O,g as I,c as g,b as M,F as S,v as h,j as i,w as R,_ as j,o as d,n as A,a as o,x as B,t as y,y as J,z as K,A as z,B as C}from"#entry";import{u as b,s as m,A as k}from"./DFRQoFTv.js";import{u as G}from"./pdb2oOUe.js";import{_ as F}from"./CcFceyxz.js";const L=()=>{const t=b();return{assignSku:r=>t.assignSku(r)}},$=()=>{const t=b();return{unassignSku:(r,p)=>t.unassignSku(r,p),unassignAllSku:r=>t.unassignAllSku(r)}};var c=(t=>(t.MODE_AUTOMATIC="automatico",t.MODE_MANUAL="manual",t))(c||{});const H=(t,r)=>t.is_enabled?r.is_master_case?"bg-blue-500":r.sku_name===m.SKU_REJECT?"bg-red-500":t.mode===c.MODE_AUTOMATIC&&t.is_enabled?"bg-lgreen3":t.mode===c.MODE_MANUAL&&t.is_enabled?"bg-yellow-600/90":"":"bg-gray-300",V={class:"flex justify-between items-start mx-1"},P={class:"text-2 font-bold text-dgreen1"},q={class:"flex gap-1"},Q=["onClick"],W=["onDrop"],X={key:0,class:"flex flex-col gap-1 overflow-y-auto pr-1 my-1"},Y=["draggable","onDragstart"],Z={class:"relative w-full flex justify-start items-center h-8"},ss={class:"px-1 text-xs font-bold"},es=["onClick"],ts={key:1,class:"flex flex-col items-center justify-center h-full"},is=O({__name:"Assignments",props:{sorter_id:{}},setup(t){const r=t,{getAssignments:p}=G(),{assignSku:N}=L(),{unassignSku:U}=$(),_=b(),w=(e,n)=>{const l=JSON.parse(e.dataTransfer?.getData("assignmentSku")??"");if(console.log(l),!l)return;const u={id:l.id??l.sku_id,sku:l.sku??l.sku_name},s=_.assignments.find(a=>a.sealer_db_id===n.sealer_db_id),f=s.assignments.find(a=>a.sku_name===u.sku);if(r.sorter_id===1&&s.mode.toUpperCase()===c.MODE_AUTOMATIC.toUpperCase()&&s.assignments.length>0){F(k.ASSIGNMENT_ERROR,!0,_.assignment_modals);return}f||N({sealer_id:s.sealer_db_id,sku_id:u.id})},E=e=>e.sku_name.toUpperCase()!==m.SKU_REJECT.toUpperCase()?!1:_.getSealersByType.flatMap(u=>u.assignments).filter(u=>u.sku_name.toUpperCase()===m.SKU_REJECT.toUpperCase()).length===1,D=(e,n,l)=>{e.dataTransfer&&e.dataTransfer.setData("assignmentSku",JSON.stringify({...n,sealer_id:l}))};return I(async()=>{await p(r.sorter_id)}),(e,n)=>{const l=T,u=j;return d(),g(S,null,[(d(!0),g(S,null,h(i(_).getSealersByType,(s,f)=>(d(),g("div",{key:f,class:A(["lg:w-60 xl:w-72 w-full p-1 mx-3 my-2 shadow-md bg-white flex flex-col justify-between",{"h-12":!s.is_expanded,"h-72":s.is_expanded}])},[o("div",V,[o("h1",P," Salida "+y(s.sealer_physical_id),1),o("div",q,[o("button",{onClick:a=>s.is_expanded=!s.is_expanded,class:"p-0.5 border border-black rounded-md"},[(d(),J(K(s.is_expanded?"IconsArrowUp":"IconsArrowDown"),{size:"1.5em",class:"text-black"}))],8,Q)])]),n[3]||(n[3]=o("hr",{class:"border w-full mt-1"},null,-1)),s.is_expanded?(d(),g("div",{key:0,onDragover:n[0]||(n[0]=z(()=>{},["prevent"])),onDrop:a=>w(a,s),class:"flex flex-col flex-grow overflow-hidden"},[s.assignments.length>0?(d(),g("div",X,[(d(!0),g(S,null,h(s.assignments,(a,v)=>(d(),g("div",{key:v,class:A(["rounded-lg flex justify-center text-white",i(H)(s,a)]),draggable:a.sku_name.toUpperCase()!==("sku_values"in e?e.sku_values:i(m)).SKU_REJECT.toUpperCase(),onDragstart:x=>D(x,a,s.sealer_db_id)},[o("div",Z,[o("h1",ss,y(a.sku_name),1),o("button",{onClick:x=>i(U)(s.sealer_db_id,a.sku_id),class:A(["absolute right-0 px-2 border-l border-white cursor-pointer",{hidden:E(a)}])},[M(l,{class:"transition-transform duration-300 hover:scale-120",size:"1.2em"})],10,es)])],42,Y))),128))])):(d(),g("div",ts,[...n[2]||(n[2]=[o("h1",{class:"px-1 text-4 font-bold text-black"},"SIN SKUs ASIGNADOS",-1)])]))],40,W)):B("",!0)],2))),128)),M(u,{toggle_modal:("getModalState"in e?e.getModalState:i(C))(("AssignmetModalNames"in e?e.AssignmetModalNames:i(k)).ASSIGNMENT_ERROR,i(_).assignment_modals).show,"onUpdate:toggle_modal":n[1]||(n[1]=s=>("getModalState"in e?e.getModalState:i(C))(("AssignmetModalNames"in e?e.AssignmetModalNames:i(k)).ASSIGNMENT_ERROR,i(_).assignment_modals).show=s)},{default:R(()=>[...n[4]||(n[4]=[o("div",{class:"flex flex-col items-center justify-center p-4"},[o("h1",{class:"title-4 text-dgreen1"},"ATENCIÓN"),o("p",{class:"mt-5 text-2 text-dgreen2"},"NO PUEDES ASIGNAR MÁS DE UN SKU A UNA SALIDA AUTOMÁTICA.")],-1)])]),_:1},8,["toggle_modal"])],64)}}});export{is as _};
