import{f as g,Z as S}from"#entry";import{g as i,p as _,a as h,r as m}from"./9e-Yg0Sx.js";var c=(s=>(s.SKU_REJECT="REJECT",s))(c||{}),o=(s=>(s.ENROLLMENT_HISTORY="EnrollmentHistory",s.SORTER_HISTORY="SorterHistory",s.SKU_GRAPHS="SkuGraphs",s.ASSIGNMENT_ERROR="AssignmentError",s))(o||{});const k=[{name:o.ENROLLMENT_HISTORY,show:!1},{name:o.SORTER_HISTORY,show:!1},{name:o.SKU_GRAPHS,show:!1},{name:o.ASSIGNMENT_ERROR,show:!1}],A=()=>({assignments:[],assignment_modals:k,filter_option_selected:null,filter_assignment_option_selected:null,filter_calibrator_selected:null,skus:[],sorter_history:[],enrollment_history:[],is_stopped_assignment_listener:!1}),y={async getEnrollmentHistory(s){try{this.enrollment_history=await i(`/assignment/sorter/${s}/enrollments`)}catch(e){console.error(e)}},async getSorterHistory(s){try{this.sorter_history=await i(`/assignment/sorter/${s}/history`)}catch(e){console.error(e)}},async getSkus(s){try{const e=await i(`/sku/assignables/${s}`);Array.isArray(e)&&(this.skus=e)}catch(e){console.error(e)}},async getAssignments(s){try{this.assignments=await i(`/sku/assigned/${s}`),this.assignments=this.assignments.map(e=>({...e,is_expanded:!0}))}catch(e){console.error(e)}},contractAllAssigment(){this.assignments=this.assignments.map(s=>({...s,is_expanded:!1}))},expandAllAssigment(){this.assignments=this.assignments.map(s=>({...s,is_expanded:!0}))}},l=(s,e="",t,r)=>{const n=g();n.notify={icon:t,show:!0,title:s,content:e,type:r}},R={async assignSku(s){try{const e=await _("/assignment",s);console.log(e),e.success?l("SKU ASIGNADO",e.message,"IconsCheckCircle","success"):l("ERROR AL ASIGNAR SKU",e.message,"IconsCrossCircle","error")}catch(e){console.error(e);const t=e?.response?.data,r=t?.message||t?.error?.message||t?.error?.details?.error_detail||e?.message||"Error al asignar SKU";l("ERROR AL ASIGNAR SKU",r,"IconsCrossCircle","error")}}},f={async toggleSealerStatus(s){try{await h(`/assignment/${s}`,{})}catch(e){console.error(e)}}},d={async unassignSku(s,e){try{await m(`/assignment/${s}/${e}`)}catch(t){console.error(t)}},async unassignAllSku(s){try{await m(`/assignment/${s}`)}catch(e){console.error(e)}},clearFilters(){this.filter_option_selected=null}},E={...y,...R,...f,...d};var a=(s=>(s[s.Automatic=1]="Automatic",s[s.Manual=2]="Manual",s))(a||{});const p={getSkusWithoutRejectBySealerFilter(s){return s.filter_assignment_option_selected===a.Automatic?s.skus.filter(e=>e.sku!==c.SKU_REJECT):s.skus},getSkusByCalibrator(s){const e=s.filter_assignment_option_selected===a.Automatic?s.skus.filter(n=>n.sku!==c.SKU_REJECT):s.skus;if(s.filter_calibrator_selected==null)return e;const t=s.filter_calibrator_selected,r=Number(t);return e.filter(n=>{const u=n.linea??n.line??n.calibrador;return u==null?!0:Number(u)===r})},getSortedSkuListWithoutReject(s){return s.skus.filter(t=>t.sku!==c.SKU_REJECT).toSorted((t,r)=>Number(r.is_master_case)-Number(t.is_master_case))},getSkusListByMaster(s){return s.skus.toSorted((e,t)=>Number(t.is_master_case)-Number(e.is_master_case))},getSealersByType:s=>{let e=[];switch(s.filter_assignment_option_selected){case a.Automatic:e=s.assignments.filter(t=>t.mode==="automatico");break;case a.Manual:e=s.assignments.filter(t=>t.mode==="manual");break}return e}},T=S("mySkuAssignmentStore",{state:A,actions:E,getters:p});export{o as A,a,c as s,T as u};
