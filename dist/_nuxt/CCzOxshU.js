const c=new Map;async function b(e){if(c.has(e))return console.warn(`WebSocket for ${e} is already connected.`),c.get(e);const t=["192.168.120.2","192.168.121.2"];let o=null,a=!1,l=null;for(const r of t){const n=`ws://${r}/${e}`;console.log(`游댋 Intentando conectar WebSocket a: ${n}`);try{o=new WebSocket(n),await new Promise((s,k)=>{o.onopen=()=>{a=!0,console.log(`CONECTADO AL WEBSOCKET NATIVO (${r})`),s()},o.onerror=S=>{l=S,k(S)}});break}catch(s){console.error(`Error conectando a WebSocket en ${r}:`,s),o=null}}if(!a||!o)throw l||new Error("No se pudo conectar a ning칰n WebSocket");return o.onclose=r=>{console.log("WebSocket desconectado:",r.reason),c.delete(e)},o.onerror=r=>{console.error("Error en WebSocket:",r)},o.onmessage=r=>{try{const n=JSON.parse(r.data);console.log("Mensaje recibido:",n)}catch{console.warn("Mensaje recibido no es JSON v치lido:",r.data)}},c.set(e,o),o}function d(e){const t=c.get(e);if(!t){console.warn(`No existe conexi칩n WebSocket activa para el namespace "${e}".`);return}if(t.readyState===WebSocket.CLOSED||t.readyState===WebSocket.CLOSING){console.log(`El WebSocket para "${e}" ya est치 cerrado o cerr치ndose.`),c.delete(e);return}console.log(`游뛁 Cerrando conexi칩n WebSocket para "${e}"...`),t.close(1e3,"Cierre manual"),c.delete(e)}export{d as c,b as s};
